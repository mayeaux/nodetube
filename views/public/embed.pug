doctype html
html
    head
        meta(charset='utf-8')
        meta(http-equiv='X-UA-Compatible', content='IE=edge')
        meta(name='viewport', content='width=device-width, initial-scale=1.0')
        meta(name='theme-color' content='#4DA5F4')
        meta(name='csrf-token', content=_csrf)
        meta(name="description", content=meta.description)

        meta(property='og:title', content=(meta.title || title))
        meta(property='og:image', content=meta.image)
        meta(property='og:description', content=meta.description)
        meta(property='og:video', content=meta.video)


        meta(name='twitter:card', content='summary')
        meta(name='twitter:site', content='@nodetube_org')
        meta(name='twitter:title', content=(meta.title || title))
        meta(name='twitter:description', content=meta.description)
        meta(name='twitter:image', content=meta.image)


        title #{title} - #{brandName}
        link(rel='shortcut icon', href='/favicon.ico')
        script(src='/js/lib/jquery-3.1.1.min.js')
        script(src='/js/lib/bootstrap.min.js')
        script(src='/js/main.js')
        script(src='https://www.google.com/recaptcha/api.js')
        script(src="https://cdnjs.cloudflare.com/ajax/libs/autolinker/1.4.4/Autolinker.js")
        script(src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js")


        link(rel="stylesheet" href="https://cdn.plyr.io/2.0.16/plyr.css")


        //link(href="//vjs.zencdn.net/5.19/video-js.min.css" rel="stylesheet")
        //script(src="//vjs.zencdn.net/5.19/video.min.js")


        script(type='text/javascript').var onloadCallback = function() {grecaptcha.render('html_element', {'sitekey' : '6LcONy8UAAAAAFi9P_oGtUUACpE_791hg7XQKyzK'});};


        script(src="/js/sweetalert.min.js")
        link(rel="stylesheet" href="/css/sweetalert.css")

        link(rel='stylesheet', href='/css/main.css')
        link(rel='stylesheet', href='/css/nodetube.css')
        link(rel="stylesheet" href="https://cdn.plyr.io/3.5.10/plyr.css")





        // Google Analytics: change UA-XXXXX-X to be your site's ID
        //script.
        //  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        //      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        //    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        //  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        //  ga('create', 'UA-105337276-1', 'auto');
        //  ga('send', 'pageview');

    style.
        body  {
            position: fixed;
            bottom: 0px;
            right: 0px;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: 100;
            overflow: hidden;
            margin:0;
            padding:0;

        }

        .plyr {
            width:100%;
            max-width:100%;
        }



    body
        div.display-div


            if upload.fileType == 'video'
                video.display-element(poster=`${uploadServer}/${upload.uploader.channelUrl}/${upload.thumbnails.custom || upload.thumbnails.generated || upload.thumbnails.medium}` controls='')

                video#media_player.display-element(poster=`${'http://localhost:3000'}/uploads/${upload.uploader.channelUrl}/${upload.thumbnails.generated || upload.thumbnails.medium}` controls='', style="max-width:100%;background-color:black;")
                    // to
                    source.video-source(src=`${'http://localhost:3000'}/uploads/${upload.uploader.channelUrl}/${upload.uniqueTag}.mp4`, type='video/mp4')


                //video.display-element(poster=upload.thumbnailUrl controls='')
                //    // TODO: Sub out thumbnail here
                //
                //    source(src=`${'http://localhost:3000'}/uploads/${upload.uploader.channelUrl}/${upload.uniqueTag}.mp4`, type='video/mp4')
                //    source(src=upload.uploadUrl, type='video/mp4')
            else if upload.fileType == 'image'
                img.display-element(src=upload.uploadUrl style="height:100%;width:100%")
            else if upload.fileType == 'audio'
                audio.my_audio(style="" controls='', preload='none')
                    source(src=upload.uploadUrl, type='audio/mp3')





        script(src="https://cdnjs.cloudflare.com/ajax/libs/plyr/3.5.10/plyr.min.js")

        script.
          var plyr_options = {
            autoplay: true,
            clickToPlay: true,
            controls: ['play-large', 'play', 'progress', 'current-time', 'duration', 'mute', 'volume', 'settings', 'fullscreen'],
            settings: ['speed', 'captions', 'quality', 'speed', 'loop']
          };

          // Create the plyr instances - this defines players[0] as our primary player.
          var players = Plyr.setup("#media_player", plyr_options);

//          players[0].on('ready', function (event) {
//            // set video max-height to 620px
//            $('.display-element').css('max-height', '620px');
//          });
//
//          players[0].on('enterfullscreen', function (event) {
//
//            $('.display-element').css('max-height', "")
//
//
//            // remove video max-height
//
//          });
//
//          players[0].on('exitfullscreen', function (event) {
//            // add max height
//            $('.display-element').css('max-height', '620px')
//          });
//
//          $("[data-plyr=seek]").css('cursor', 'pointer')
//
//          $("[data-plyr=volume]").css('cursor', 'pointer')

